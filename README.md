# 数据分析工具使用指南

## 📋 工具简介

这是一个专门用于分析Excel测试数据的工具，能够自动识别数据中的异常情况，生成详细的统计报告和可视化图表。

## 🎯 主要功能

- **数据筛选**：自动筛选有效的测试数据列
- **统计分析**：计算均值、标准差等统计指标
- **异常检测**：识别警告数据和超限数据
- **报告生成**：生成详细的Excel分析报告
- **图表可视化**：生成正态分布图和排名柱状图
- **前十名汇总**：自动汇总问题最多的前10个测试项

## 📁 文件结构

```
ExcelDataAnalysis/
├── data_analysis_integrated_v2.py    # 主程序文件
├── README_数据分析工具.md             # 本说明文件
├── requirements.txt                   # 依赖包列表
└── 示例数据文件.xlsx                  # 您的Excel数据文件
```

## 🔧 环境准备

### 1. 安装Python
确保您的电脑已安装Python 3.7或更高版本。

### 2. 安装依赖包
在命令行中运行以下命令安装所需的包：

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install pandas numpy matplotlib scipy openpyxl
```

## 📊 数据格式要求

您的Excel文件需要按照以下格式组织：

| 列名 | 第1行 | 第2行 | 第3行 | 第4行及以后 |
|------|-------|-------|-------|-------------|
| 测试项1 | 测试项名称 | 下限值 | 上限值 | 实际测试数据 |
| 测试项2 | 测试项名称 | 下限值 | 上限值 | 实际测试数据 |
| ... | ... | ... | ... | ... |

**重要说明：**
- 第1行：测试项的名称（如"电池电压"、"电机转速"等）
- 第2行：该测试项的下限值
- 第3行：该测试项的上限值
- 第4行开始：实际的测试数据

## 🚀 使用方法

### 方法一：命令行运行

1. **打开命令行**（Windows按Win+R，输入cmd）

2. **切换到程序所在目录**
   ```bash
   cd 路径/到/ExcelDataAnalysis
   ```

3. **运行程序**
   ```bash
   python data_analysis_integrated_v2.py 您的文件名.xlsx
   ```

### 方法二：交互式运行

1. **直接运行程序**
   ```bash
   python data_analysis_integrated_v2.py
   ```

2. **按提示输入文件名**
   ```
   请输入Excel文件名（例如：data.xlsx）：您的文件名.xlsx
   ```

## 📈 输出结果

程序运行完成后，会在当前目录下生成一个以时间戳命名的文件夹，例如：
```
Report_2513FCT_综合分析_20250815_153000/
```

### 文件夹内容：

1. **Excel报告文件**：`Data_Analysis_Report_时间戳.xlsx`
   - 警告数据表：显示接近上下限的数据
   - 超限数据表：显示超出上下限的数据
   - 测试项排名表：按问题数量排序的测试项
   - 复测率统计：统计重复测试的情况

2. **图表文件**：
   - 各测试项的正态分布图（.png格式）
   - 排名柱状图（.png格式）
   - 合并排名图（.png格式）

3. **前十名汇总文件夹**：
   - 包含问题最多的前10个测试项的图表
   - 文件名包含排名和问题数量

## 📋 报告解读

### 警告数据
- **定义**：距离上下限5%范围内的数据
- **意义**：虽然未超限，但需要关注

### 超限数据
- **定义**：超出上下限的数据
- **意义**：存在质量问题，需要处理

### 排名表
- 按问题数量从多到少排序
- 帮助识别最需要关注的测试项

## ⚠️ 常见问题

### Q1: 程序提示"找不到文件"
**解决方案：**
- 确保文件名拼写正确
- 确保文件在正确的目录中
- 可以输入完整路径，如：`C:\Users\用户名\Desktop\数据.xlsx`

### Q2: 程序提示"没有找到符合条件的有效列"
**解决方案：**
- 检查Excel文件格式是否正确
- 确保第2行和第3行是数值
- 确保第2行和第3行的数值不相等

### Q3: 生成的图表中文显示为方框
**解决方案：**
- 确保系统安装了中文字体
- Windows用户通常不需要额外设置

### Q4: 程序运行很慢
**解决方案：**
- 这是正常现象，特别是数据量大的时候
- 程序需要处理每个测试项并生成图表
- 请耐心等待完成

## 🔍 高级功能

### 数据筛选逻辑
程序会自动筛选有效的测试列：
- 排除名为"DUT_DID"的列
- 第2行和第3行必须是有效数字
- 第2行和第3行的数值不能相等

### 统计计算
- 均值（μ）：数据的平均值
- 标准差（σ）：数据的离散程度
- 正态分布：用于判断数据是否异常

### 异常检测
- 警告范围：上下限±5%范围内
- 超限范围：超出上下限
- 3σ原则：超出均值±3倍标准差的数据

## 📞 技术支持

如果遇到问题，请检查：
1. Python版本是否为3.7+
2. 所有依赖包是否正确安装
3. Excel文件格式是否符合要求
4. 文件路径是否正确

## 📝 更新日志

- **V2版本**：增加了Excel报告生成、排名图表、前十名汇总等功能
- **V1版本**：基础的数据分析和图表生成功能

---

**祝您使用愉快！** 🎉 
